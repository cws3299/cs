# 로드밸런싱

### 1. Load Balancer가 필요한 이유

- Client가 한 두명인 경우 Server는 여유롭게 사용자가 원하는 결과를 응답 해줄 수 있다.

  하지만 Client가 수천만명이라면 Server는 모든 사람들의 응답을 해주려고 노력하지만 결국엔 동작을 멈추게 된다.

- 해결하기 위한 방법

  - `Scale-up` : Server가 더 빠르게 동작하기 위해 하드웨어 성능을 올리는 방법
  - `Scale-out` : 하나의 Server 보다는 여러 대의 Server가 나눠서 일을 하는 방법

- Scale-out의 장점

  - 하드웨어 향상하는 비용보다 서버 한대 추가 비용이 더 적다.
- 여러대의 Server 덕분에 무중단 서비스를 제공할 수 있다. 
  

=> 여러대의 Server에게 균등하게 Traffic을 분산시켜주는 역항르 하는 것이 `Load Balncer`이다.



### 2. Load Balancing 이란

하나의 인터넷 서비스가 발생하는 트래픽이 많을 대 여러 대의 서버가 분산처리하여 서버의 로드율 증가, 부하량, 속도저하 등을 고려하여 적절히 분산처리하여 해결해주는 서비스이다.

=> 부하가 일어나지 않도록 여러 서버에 분산시켜주는 방식, 사이트 규모에 따라 웹 서버를 추가로 증설하면서 로드 밸런서로 관리해주면 웹 서버의 부하를 해결할 수 있다. 

  

### 3. 로드밸런싱 알고리즘

- 라운드로빈 방식 (Round Robin Method)

  서버에 들어온 요청을 순서대로 돌아가며 배정하는 방식이다. 

  클라이언트 요청을 순서대로 분배하기 때문에 여러대의 서버가 동일한 스펙을 갖고 있고, 서버와의 연결(세션)이 오래 지속되지 않은 경우 활용

- 가중 라운드로빈 방식 (Weighted Round Robin Method)

  각각의 서버마다 가중치를 매기고 가중치가 높은 서버에 클라이언트 요청을 우선적으로 배분한다. 주로 서버의 트래픽 처리 능력이 상이한 경우 사용되는 분산 방식이다.

  예로, A서버가 5라는 가중치를 갖고 B서버가 2라는 가중치를 갖는다면,  로드밸런서는 라운드로빈 방식으로 A 서버에 5개, B 서버에 2개의 요청을 전달한다.

- IP 해시 방식 (IP Hash Method)

  클라이언트의 IP 주소를 특저어 서버로 매핑하여 요청을 처리하느 방식이다.

  사용자의 IP를 해싱해(임의의 길이를 지닌 데이터를 고정된 길이의 데이터로 매핑하는 것) 로드를 분배하기 때문에 사용자가 항상 동일한 서버로 연결되는 것을 보장한다.

- 최소 연결 방식(Least Connection Method)

  요청이 들어온 시점에 가장 적은 연결상태를 보이는 우선적으로 트래픽을 배분한다.

  세션이 자주 길어지거나, 서버에 분배된 트래픽들이 일정하지 않은 경우에 적합한 방식이다.

- 최소 리스폰타임 (Least Response Time Method)

  서버의 현재 연결 상태와 응답시간을 모두 고려하여 트래픽을 배분한다.

  가장 적은 연결 상태와 가장 짧은 응답시간을 보이느 서버에 우선적으로 로드를 배분하는 방식이다.



[참고]

- https://nesoy.github.io/articles/2018-06/Load-Balancer
- https://post.naver.com/viewer/postView.nhn?volumeNo=27046347&memberNo=2521903

